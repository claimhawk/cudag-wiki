# Dataset Viewer Project Overview

## 1. Overview

The `dataset-viewer` is a Next.js-based web application designed to provide an interactive, navigable interface for exploring and viewing datasets, particularly those generated by AI or data annotation pipelines. It enables users to browse datasets by generator, navigate through indexed records, view record details, and filter by task type or other metadata.

This project solves the problem of managing and visualizing large, structured datasets in a user-friendly, searchable, and paginated interface — especially useful for data scientists, annotators, and AI researchers who need to inspect, validate, or analyze generated data (e.g., images, text, or structured records) in context.

The application is built with a modular, component-driven architecture and leverages Next.js App Router for routing, enabling dynamic paths like `/[generator]/[dataset]/[index]/record-viewer` to represent hierarchical dataset navigation.

---

## 2. Architecture

The codebase follows a structured, layered architecture with clear separation of concerns:

### Core Directories:

- **`src/app/`** — Next.js App Router routes and layout components.
  - `layout.tsx`: Root layout component that wraps all pages with shared UI (e.g., header, navigation).
  - `page.tsx`: Home page — likely serves as the entry point to dataset selection.
  - `[generator]/page.tsx`: Entry point for a specific dataset generator.
  - `[generator]/[dataset]/page.tsx`: Entry point for a specific dataset within a generator.
  - `[generator]/[dataset]/[index]/page.tsx`: Entry point for a specific index (e.g., page 1, 2, 3) of records.
  - `[generator]/[dataset]/[index]/record-viewer.tsx`: Component for rendering a single record’s content.
  - `[generator]/[dataset]/[index]/record-nav-url.tsx`: Utility component for generating or displaying record navigation URLs.

- **`src/ui/`** — Reusable UI components, organized by purpose.
  - `viewer/` — Components specific to the dataset viewer UI:
    - `task-type-filter.component.tsx`: Filter component for selecting task types (e.g., “classification”, “segmentation”).
    - `image-viewer.component.tsx`: Component for rendering and interacting with image records.
    - `search-field.component.tsx`: Search bar for filtering records.
    - `dataset-selector.component.tsx`: Dropdown or selector for choosing datasets.
    - `record-details.component.tsx`: Displays metadata and content of a selected record.
    - `record-nav.component.tsx`: Navigation controls for moving between records in an index.
  - `primitives/` — Fundamental UI components (buttons, inputs, checkboxes, selects) that are reused across the app.
    - `button.component.tsx`, `input.component.tsx`, `checkbox.component.tsx`, `select.component.tsx`

- **`src/libs/`** — Utility and configuration libraries.
  - `config/adapters-config.lib.ts`: Configuration for data adapters (e.g., how to fetch data from different sources).
  - `paths/generators-path.lib.ts`: Utility for constructing or parsing generator/dataset/index paths.
  - `coordinates/resolution-units.lib.ts`: Utility for handling coordinate systems or resolution units (likely for image datasets).
  - `api/` — API route handlers:
    - `navigate/route.ts`: Handles navigation requests (e.g., “go to record at index 10”).
    - `records/route.ts`: Fetches record data for a given index.
    - `image/[...path]/route.ts`: Handles dynamic image paths (e.g., `/image/12345.jpg` or `/image/12345/preview`).

- **`src/app/layout.tsx`** — Root layout component that provides global styling, theme, and shared UI elements (e.g., navigation bar, footer).

---

## 3. Key Components

### UI Components:

- **`record-viewer.tsx`** — The core component that renders the content of a single record. It likely receives record data from the API and renders it conditionally based on type (image, text, etc.).
- **`record-nav.component.tsx`** — Enables navigation between records (previous/next, jump to index). Likely uses the `record-nav-url.tsx` component to generate URLs for navigation.
- **`dataset-selector.component.tsx`** — Allows users to select a dataset from a list of available datasets within a generator.
- **`search-field.component.tsx`** — Enables filtering records by text search (e.g., search by label, metadata, or content).
- **`task-type-filter.component.tsx`** — Filters records by task type (e.g., “classification”, “detection”, “segmentation”).

### API Components:

- **`src/app/api/records/route.ts`** — Fetches records for a given dataset index. Likely returns a paginated list of records with metadata.
- **`src/app/api/navigate/route.ts`** — Handles navigation requests (e.g., “go to record at index 100”). May return a record object or redirect.
- **`src/app/api/image/[...path]/route.ts`** — Handles dynamic image requests. May serve image files or generate thumbnails or previews.

### Utility Components:

- **`src/libs/config/adapters-config.lib.ts`** — Defines how data is fetched from different sources (e.g., local storage, remote API, database).
- **`src/libs/paths/generators-path.lib.ts`** — Utility for constructing or parsing dynamic route paths (e.g., `/generator/dataset/index`).
- **`src/libs/coordinates/resolution-units.lib.ts`** — Utility for handling coordinate systems (e.g., pixel, normalized, or geo coordinates).

---

## 4. Data Flow

The data flow follows a client-server pattern with Next.js API routes and client-side components:

1. **User Navigation**:
   - User navigates to `/[generator]/[dataset]/[index]/` via UI or direct URL.
   - The route handler (`page.tsx` or `record-viewer.tsx`) loads the appropriate data.

2. **Data Fetching**:
   - The `records/route.ts` API endpoint is called to fetch records for the given index.
   - Records are returned as a list of objects with metadata (e.g., `id`, `taskType`, `label`, `imagePath`).

3. **Record Rendering**:
   - `record-viewer.tsx` receives the record data and renders it based on its type (e.g., image, text, table).
   - If the record is an image, `image-viewer.component.tsx` is rendered to display the image.

4. **Navigation & Filtering**:
   - `record-nav.component.tsx` and `record-nav-url.tsx` handle navigation between records.
   - `task-type-filter.component.tsx` and `search-field.component.tsx` allow users to filter records, which triggers a new API request to `records/route.ts` with updated filters.

5. **Dynamic Image Requests**:
   - When a user clicks on an image, the `image/[...path]/route.ts` API is called to serve the image file or generate a preview.

6. **State Management**:
   - State is managed client-side via React hooks (e.g., `useState`, `useEffect`) in components like `page.tsx` and `record-viewer.tsx`.
   - No global state management library (e.g., Redux, Zustand) is visible — state is likely scoped per component.

---

## 5. Getting Started

### Prerequisites

- Node.js (v18+ recommended)
- npm, yarn, pnpm, or bun (any package manager)

### Setup

1. **Clone the repository** (if not already done):

   ```bash
   git clone <repository-url>
   cd dataset-viewer
   ```

2. **Install dependencies**:

   ```bash
   npm install
   # or
   yarn install
   # or
   pnpm install
   # or
   bun install
   ```

3. **Start the development server**:

   ```bash
   npm run dev
   # or
   yarn dev
   # or
   pnpm dev
   # or
   bun dev
   ```

4. **Open the app**:

   Visit [http://localhost:3000](http://localhost:3000) in your browser.

5. **Start editing**:

   - The main UI components are in `src/ui/viewer/`.
   - The route handlers are in `src/app/api/`.
   - The layout and routing are in `src/app/`.
   - Configuration and utilities are in `src/libs/`.

6. **Testing**:

   - Unit tests are not visible in the current structure — consider adding Jest or Vitest tests for components.
   - Integration tests can be added using Playwright or Cypress.

7. **Deployment**:

   - Deploy to Vercel using the [Next.js deployment guide](https://nextjs.org/docs/app/building-your-application/deploying).
   - Ensure environment variables (e.g., API keys, dataset paths) are configured in `.env.local`.

---

## Additional Notes

- The project uses **Next.js App Router** (v13+), which enables dynamic routing with `[generator]/[dataset]/[index]/` paths.
- The UI is built with **React components**, and styling is likely handled via CSS modules or Tailwind (not explicitly visible in the files).
- The project includes **code quality guidelines** in `CODE_QUALITY.md` and **agent documentation** in `agents.md`, suggesting it may be part of a larger AI or data pipeline system.
- The `next.config.ts` and `tsconfig.json` files are present, indicating TypeScript is used for type safety.

This project is well-suited for teams working with large, structured datasets and requires minimal setup to get started.